<script type="text/javascript" src="/assets/js/main.js"></script>
<script type="text/javascript" src="/assets/js/dark-mode.js"></script>
<script type="text/javascript" src="/assets/js/nav-override.js"></script>
<script type="text/javascript" src="/assets/js/mobile-responsive-new.js"></script>
<script type="text/javascript" src="/assets/js/title-fix.js"></script>
<script type="text/javascript" src="/assets/js/tag-fix.js"></script>
<script type="text/javascript" src="/assets/js/inline-tags-fix.js"></script>
<script type="text/javascript" src="/assets/js/mobile-tag-fix.js"></script>
<script type="text/javascript" src="/assets/js/no-hamburger.js"></script>
<script type="text/javascript" src="/assets/js/direct-tag-fix.js"></script>
<script type="text/javascript" src="/assets/js/force-inline-tags.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid@10.8.0/dist/mermaid.min.js"></script>
<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
    // Initialize Mermaid
    mermaid.initialize({
      startOnLoad: false, // We'll manually render diagrams
      theme: document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'
    });

    // Find all code blocks with language-mermaid class and convert them
    document.querySelectorAll('pre code.language-mermaid').forEach(function(codeBlock) {
      // Save the original code
      var originalCode = codeBlock.textContent;

      // Create a div to replace the code block
      var div = document.createElement('div');
      div.className = 'mermaid';
      div.innerHTML = originalCode;
      div.style.backgroundColor = 'transparent';

      // Store the original code for potential re-renders
      div.setAttribute('data-original-code', originalCode);

      // Replace the <pre><code> with the mermaid div
      var pre = codeBlock.parentNode;
      pre.parentNode.replaceChild(div, pre);
    });

    // Run the renderer
    try {
      mermaid.run();
    } catch (e) {
      console.error('Error initializing Mermaid diagrams:', e);
    }
  });
</script>
{% include disqus-scripts.html %}
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-59342910-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  // Universal Analytics configuration
  gtag('config', 'UA-59342910-1', {
    'anonymize_ip': true,
    'cookie_flags': 'SameSite=None;Secure'
  });
</script>
{% if page.extra_scripts %}
  {% for script in page.extra_scripts %}
    <script type="text/javascript" src="{{ script }}"></script>
  {% endfor %}
{% endif %}
